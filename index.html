<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Decision Odds">
  <meta name="theme-color" content="#4f46e5">
  <title>Decision Odds Calculator</title>
  <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkRlY2lzaW9uIE9kZHMgQ2FsY3VsYXRvciIsCiAgInNob3J0X25hbWUiOiAiRGVjaXNpb24gT2RkcyIsCiAgInN0YXJ0X3VybCI6ICIvIiwKICAiZGlzcGxheSI6ICJzdGFuZGFsb25lIiwKICAiYmFja2dyb3VuZF9jb2xvciI6ICIjZjBmNGZmIiwKICAidGhlbWVfY29sb3IiOiAiIzRmNDZlNSIsCiAgImljb25zIjogW10KfQ==">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

```
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background: linear-gradient(135deg, #f0f4ff 0%, #e0e7ff 100%);
  min-height: 100vh;
  padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
  overflow-x: hidden;
}

.container {
  max-width: 800px;
  margin: 0 auto;
  padding: 16px;
}

.card {
  background: white;
  border-radius: 12px;
  padding: 24px;
  margin-bottom: 16px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

h1 {
  font-size: 28px;
  font-weight: bold;
  color: #1f2937;
  margin-bottom: 8px;
}

.subtitle {
  font-size: 16px;
  color: #6b7280;
  margin-bottom: 20px;
}

.button-row {
  display: flex;
  gap: 8px;
  margin-bottom: 16px;
}

.btn {
  flex: 1;
  padding: 12px 16px;
  border: none;
  border-radius: 8px;
  font-size: 16px;
  font-weight: 600;
  cursor: pointer;
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
  transition: all 0.2s;
  touch-action: manipulation;
}

.btn:active {
  transform: scale(0.98);
}

.btn-primary {
  background: #4f46e5;
}

.btn-primary:hover {
  background: #4338ca;
}

.btn-secondary {
  background: #6b7280;
}

.btn-secondary:hover {
  background: #4b5563;
}

.btn-success {
  background: #10b981;
  width: 100%;
}

.btn-success:hover {
  background: #059669;
}

.saved-section {
  background: #f9fafb;
  border-radius: 8px;
  padding: 16px;
  margin-top: 16px;
}

.saved-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: white;
  padding: 16px;
  border-radius: 8px;
  margin-bottom: 8px;
  border: 1px solid #e5e7eb;
  cursor: pointer;
  transition: all 0.2s;
}

.saved-item:hover {
  border-color: #818cf8;
}

.saved-item:active {
  transform: scale(0.98);
}

.saved-title {
  font-size: 16px;
  font-weight: 600;
  color: #1f2937;
  margin-bottom: 4px;
}

.saved-subtitle {
  font-size: 14px;
  color: #6b7280;
}

.delete-btn {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  padding: 8px;
}

.label {
  font-size: 14px;
  font-weight: 600;
  color: #374151;
  margin-bottom: 8px;
  display: block;
}

input[type="text"] {
  width: 100%;
  padding: 12px;
  border: 1px solid #d1d5db;
  border-radius: 8px;
  font-size: 16px;
  margin-bottom: 20px;
  -webkit-appearance: none;
}

input[type="text"]:focus {
  outline: none;
  border-color: #4f46e5;
  box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
}

.factors-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 16px;
}

.factors-toggle {
  font-size: 20px;
  font-weight: 600;
  color: #1f2937;
  cursor: pointer;
  user-select: none;
  display: flex;
  align-items: center;
  gap: 8px;
}

.add-factor-btn {
  background: #4f46e5;
  color: white;
  border: none;
  padding: 8px 16px;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 600;
  cursor: pointer;
}

.factor {
  background: #f9fafb;
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  padding: 16px;
  margin-bottom: 12px;
}

.factor-header {
  display: flex;
  gap: 8px;
  margin-bottom: 12px;
}

.factor-input {
  flex: 1;
  margin-bottom: 0;
}

.remove-btn {
  background: #ef4444;
  color: white;
  border: none;
  width: 44px;
  height: 44px;
  border-radius: 8px;
  font-size: 24px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.control-group {
  margin-bottom: 16px;
}

.type-toggle {
  display: flex;
  gap: 8px;
}

.type-btn {
  flex: 1;
  padding: 10px;
  border: 1px solid #d1d5db;
  background: white;
  border-radius: 8px;
  font-size: 14px;
  font-weight: 600;
  color: #6b7280;
  cursor: pointer;
  transition: all 0.2s;
}

.type-btn.active {
  background: #4f46e5;
  border-color: #4f46e5;
  color: white;
}

.slider-container {
  display: flex;
  align-items: center;
  gap: 12px;
}

.slider-btn {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: #4f46e5;
  color: white;
  border: none;
  font-size: 18px;
  font-weight: bold;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.slider-track {
  flex: 1;
  height: 8px;
  background: #e5e7eb;
  border-radius: 4px;
  position: relative;
  overflow: hidden;
}

.slider-fill {
  height: 100%;
  background: #4f46e5;
  transition: width 0.2s;
}

.odds-card {
  background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
  border-radius: 8px;
  padding: 24px;
  color: white;
  margin: 20px 0;
}

.odds-title {
  font-size: 18px;
  font-weight: 600;
  margin-bottom: 16px;
}

.odds-content {
  display: flex;
  align-items: center;
  gap: 20px;
}

.odds-number {
  font-size: 48px;
  font-weight: bold;
}

.odds-bar {
  flex: 1;
  height: 16px;
  background: rgba(255, 255, 255, 0.3);
  border-radius: 8px;
  overflow: hidden;
}

.odds-bar-fill {
  height: 100%;
  background: white;
  transition: width 0.3s;
}

.empty-state {
  text-align: center;
  padding: 48px 24px;
}

.empty-text {
  font-size: 16px;
  color: #6b7280;
  text-align: center;
  padding: 32px 0;
}

.hidden {
  display: none;
}

@media (max-width: 640px) {
  .container {
    padding: 12px;
  }

  .card {
    padding: 16px;
  }

  h1 {
    font-size: 24px;
  }

  .odds-number {
    font-size: 36px;
  }

  .odds-content {
    flex-direction: column;
    align-items: flex-start;
    gap: 12px;
  }

  .odds-bar {
    width: 100%;
  }
}
```

  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h1>Decision Odds Calculator</h1>
      <p class="subtitle">Make better decisions by thinking in odds</p>

```
  <div class="button-row">
    <button class="btn btn-primary" onclick="app.createNewDecision()">
      <span>‚ûï</span> New Decision
    </button>
    <button class="btn btn-secondary" onclick="app.toggleSaved()">
      <span id="savedToggleIcon">‚ñ∂</span> Saved (<span id="savedCount">0</span>)
    </button>
  </div>

  <div id="savedSection" class="saved-section hidden">
    <div id="savedList"></div>
  </div>
</div>

<div id="currentDecisionCard" class="hidden">
  <div class="card">
    <label class="label">Decision / Hypothesis</label>
    <input 
      type="text" 
      id="decisionTitle" 
      placeholder="e.g., Should I take this job?"
      oninput="app.updateTitle(this.value)"
    >

    <div class="factors-header">
      <div class="factors-toggle" onclick="app.toggleFactors()">
        <span id="factorsToggleIcon">‚ñº</span>
        <span>Factors (<span id="factorCount">0</span>)</span>
      </div>
      <button class="add-factor-btn" onclick="app.addFactor()">
        ‚ûï Add Factor
      </button>
    </div>

    <div id="factorsContainer"></div>

    <div class="odds-card">
      <div class="odds-title">Overall Odds</div>
      <div class="odds-content">
        <div class="odds-number" id="overallOdds">50%</div>
        <div class="odds-bar">
          <div class="odds-bar-fill" id="oddsBarFill" style="width: 50%"></div>
        </div>
      </div>
    </div>

    <button class="btn btn-success" onclick="app.saveDecision()">
      üíæ Save Decision
    </button>
  </div>
</div>

<div id="emptyState" class="card empty-state">
  <p class="empty-text">Create a new decision or load a saved one to get started</p>
  <button class="btn btn-primary" onclick="app.createNewDecision()">
    Create New Decision
  </button>
</div>
```

  </div>

  <script>
    const app = {
      decisions: [],
      currentDecision: null,
      showSaved: false,
      showFactors: true,

      init() {
        this.loadDecisions();
        this.render();
      },

      loadDecisions() {
        const saved = localStorage.getItem('decisions');
        if (saved) {
          this.decisions = JSON.parse(saved);
        }
      },

      saveDecisions() {
        localStorage.setItem('decisions', JSON.stringify(this.decisions));
      },

      createNewDecision() {
        this.currentDecision = {
          id: Date.now().toString(),
          title: '',
          factors: [],
          lastModified: Date.now()
        };
        this.showFactors = true;
        this.render();
        document.getElementById('decisionTitle').focus();
      },

      loadDecision(id) {
        const decision = this.decisions.find(d => d.id === id);
        if (decision) {
          this.currentDecision = JSON.parse(JSON.stringify(decision));
          this.showFactors = true;
          this.render();
        }
      },

      deleteDecision(id) {
        if (confirm('Are you sure you want to delete this decision?')) {
          this.decisions = this.decisions.filter(d => d.id !== id);
          this.saveDecisions();
          if (this.currentDecision?.id === id) {
            this.currentDecision = null;
          }
          this.render();
        }
      },

      saveDecision() {
        if (!this.currentDecision || !this.currentDecision.title.trim()) {
          alert('Please add a decision title first');
          return;
        }

        this.currentDecision.lastModified = Date.now();

        const existingIndex = this.decisions.findIndex(d => d.id === this.currentDecision.id);
        if (existingIndex >= 0) {
          this.decisions[existingIndex] = this.currentDecision;
        } else {
          this.decisions.unshift(this.currentDecision);
        }

        this.decisions.sort((a, b) => b.lastModified - a.lastModified);
        this.saveDecisions();
        alert('Decision saved successfully!');
        this.render();
      },

      updateTitle(value) {
        if (this.currentDecision) {
          this.currentDecision.title = value;
        }
      },

      addFactor() {
        if (!this.currentDecision) return;

        this.currentDecision.factors.push({
          id: Date.now().toString(),
          name: '',
          likelihood: 50,
          weight: 5,
          type: 'for'
        });
        this.render();
      },

      updateFactor(id, field, value) {
        const factor = this.currentDecision.factors.find(f => f.id === id);
        if (factor) {
          factor[field] = value;
          this.render();
        }
      },

      removeFactor(id) {
        this.currentDecision.factors = this.currentDecision.factors.filter(f => f.id !== id);
        this.render();
      },

      toggleSaved() {
        this.showSaved = !this.showSaved;
        this.render();
      },

      toggleFactors() {
        this.showFactors = !this.showFactors;
        this.render();
      },

      calculateOdds() {
        if (!this.currentDecision || this.currentDecision.factors.length === 0) return 50;

        let totalWeightedScore = 0;
        let totalWeight = 0;

        this.currentDecision.factors.forEach(factor => {
          const weight = factor.weight || 1;
          const adjustedLikelihood = factor.type === 'for' ? factor.likelihood : (100 - factor.likelihood);
          totalWeightedScore += adjustedLikelihood * weight;
          totalWeight += weight;
        });

        return totalWeight > 0 ? Math.round(totalWeightedScore / totalWeight) : 50;
      },

      render() {
        // Update saved count
        document.getElementById('savedCount').textContent = this.decisions.length;

        // Update saved toggle icon
        document.getElementById('savedToggleIcon').textContent = this.showSaved ? '‚ñº' : '‚ñ∂';

        // Render saved section
        const savedSection = document.getElementById('savedSection');
        if (this.showSaved) {
          savedSection.classList.remove('hidden');
          const savedList = document.getElementById('savedList');
          if (this.decisions.length === 0) {
            savedList.innerHTML = '<p class="empty-text">No saved decisions yet</p>';
          } else {
            savedList.innerHTML = this.decisions.map(decision => `
              <div class="saved-item" onclick="app.loadDecision('${decision.id}')">
                <div>
                  <div class="saved-title">${decision.title || 'Untitled'}</div>
                  <div class="saved-subtitle">${decision.factors.length} factors</div>
                </div>
                <button class="delete-btn" onclick="event.stopPropagation(); app.deleteDecision('${decision.id}')">üóëÔ∏è</button>
              </div>
            `).join('');
          }
        } else {
          savedSection.classList.add('hidden');
        }

        // Show/hide main sections
        const currentCard = document.getElementById('currentDecisionCard');
        const emptyState = document.getElementById('emptyState');

        if (this.currentDecision) {
          currentCard.classList.remove('hidden');
          emptyState.classList.add('hidden');

          // Update title input
          document.getElementById('decisionTitle').value = this.currentDecision.title;

          // Update factor count
          document.getElementById('factorCount').textContent = this.currentDecision.factors.length;

          // Update factors toggle icon
          document.getElementById('factorsToggleIcon').textContent = this.showFactors ? '‚ñº' : '‚ñ∂';

          // Render factors
          const factorsContainer = document.getElementById('factorsContainer');
          if (this.showFactors) {
            if (this.currentDecision.factors.length === 0) {
              factorsContainer.innerHTML = '<p class="empty-text">No factors yet. Add your first factor to begin.</p>';
            } else {
              factorsContainer.innerHTML = this.currentDecision.factors.map(factor => `
                <div class="factor">
                  <div class="factor-header">
                    <input 
                      type="text" 
                      class="factor-input" 
                      value="${factor.name}"
                      placeholder="Factor name"
                      oninput="app.updateFactor('${factor.id}', 'name', this.value)"
                    >
                    <button class="remove-btn" onclick="app.removeFactor('${factor.id}')">√ó</button>
                  </div>

                  <div class="control-group">
                    <label class="label">Type</label>
                    <div class="type-toggle">
                      <button 
                        class="type-btn ${factor.type === 'for' ? 'active' : ''}"
                        onclick="app.updateFactor('${factor.id}', 'type', 'for')"
                      >For</button>
                      <button 
                        class="type-btn ${factor.type === 'against' ? 'active' : ''}"
                        onclick="app.updateFactor('${factor.id}', 'type', 'against')"
                      >Against</button>
                    </div>
                  </div>

                  <div class="control-group">
                    <label class="label">Likelihood: ${factor.likelihood}%</label>
                    <div class="slider-container">
                      <button class="slider-btn" onclick="app.updateFactor('${factor.id}', 'likelihood', Math.max(0, ${factor.likelihood} - 5))">‚àí</button>
                      <div class="slider-track">
                        <div class="slider-fill" style="width: ${factor.likelihood}%"></div>
                      </div>
                      <button class="slider-btn" onclick="app.updateFactor('${factor.id}', 'likelihood', Math.min(100, ${factor.likelihood} + 5))">+</button>
                    </div>
                  </div>

                  <div class="control-group">
                    <label class="label">Weight: ${factor.weight}/10</label>
                    <div class="slider-container">
                      <button class="slider-btn" onclick="app.updateFactor('${factor.id}', 'weight', Math.max(1, ${factor.weight} - 1))">‚àí</button>
                      <div class="slider-track">
                        <div class="slider-fill" style="width: ${(factor.weight / 10) * 100}%"></div>
                      </div>
                      <button class="slider-btn" onclick="app.updateFactor('${factor.id}', 'weight', Math.min(10, ${factor.weight} + 1))">+</button>
                    </div>
                  </div>
                </div>
              `).join('');
            }
          } else {
            factorsContainer.innerHTML = '';
          }

          // Update odds
          const odds = this.calculateOdds();
          document.getElementById('overallOdds').textContent = `${odds}%`;
          document.getElementById('oddsBarFill').style.width = `${odds}%`;

        } else {
          currentCard.classList.add('hidden');
          emptyState.classList.remove('hidden');
        }
      }
    };

    // Initialize app
    app.init();

    // Register service worker for PWA
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('data:text/javascript;base64,c2VsZi5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgKCkgPT4gc2VsZi5za2lwV2FpdGluZygpKTs=');
    }
  </script>

</body>
</html>
